y=sapply(x, function(x1) { rnorm(1, mean=x1*0.001, sd=0.2) })
plot(x,y)
cor.test(x,y)
x=seq(0, 100, by=1)
y=sapply(x, function(x1) { rnorm(1, mean=x1*0.001, sd=0.2) })
plot(x,y)
cor.test(x,y)
x=seq(0, 100, by=1)
y=sapply(x, function(x1) { rnorm(1, mean=x1*0.001, sd=0.2) })
plot(x,y)
cor.test(x,y)
x=seq(0, 100, by=1)
y=sapply(x, function(x1) { rnorm(1, mean=x1*0.001, sd=0.2) })
plot(x,y)
cor.test(x,y)
citation()
citation("pheatmap")
?rperm
?permutation
?itertools
?permutation
??permutation
sample.int(4,4)
sample.int(4,4)
sample.int(4,4)
sample.int(4,4)
sample.int(4,4)
sample(4, 4)
sample(4, 4)
sample(4, 4)
sample(4, 4)
# One random permutation of 4 things
rep(n, sample(4,4))
n <- 90
# One random permutation of 4 things
rep(n, sample(4,4))
?sapply
lapply(1:90, sample(4,4))
lapply(1:90, function(x) { sample(4,4) })
sapply(1:90, function(x) { sample(4,4) })
library(ggplot2)
library(ggbeeswarm)
n <- 90
# One random permutation of 4 things
all_rankings = sapply(1:n, function(x) { sample(4,4) })
all_rankings
t(all_rankings)
apply(t(all_rankings), 2, mean)
apply(t(all_rankings), 2, mean)
library(ggplot2)
library(ggbeeswarm)
n <- 90
# One random permutation of 4 things
all_rankings = sapply(1:n, function(x) { sample(4,4) })
apply(t(all_rankings), 2, mean)
library(ggplot2)
library(ggbeeswarm)
n <- 90
# One random permutation of 4 things
all_rankings = sapply(1:n, function(x) { sample(4,4) })
apply(t(all_rankings), 2, mean)
library(ggplot2)
library(ggbeeswarm)
n <- 90
# One random permutation of 4 things
all_rankings = sapply(1:n, function(x) { sample(4,4) })
apply(t(all_rankings), 2, mean)
library(ggplot2)
library(ggbeeswarm)
n <- 90
# One random permutation of 4 things
all_rankings = sapply(1:n, function(x) { sample(4,4) })
apply(t(all_rankings), 2, mean)
library(ggplot2)
library(ggbeeswarm)
n <- 90
# One random permutation of 4 things
all_rankings = sapply(1:n, function(x) { sample(4,4) })
apply(t(all_rankings), 2, mean)
library(ggplot2)
library(ggbeeswarm)
n <- 90
# One random permutation of 4 things
all_rankings = sapply(1:n, function(x) { sample(4,4) })
apply(t(all_rankings), 2, mean)
library(ggplot2)
library(ggbeeswarm)
n <- 90
# One random permutation of 4 things
all_rankings = sapply(1:n, function(x) { sample(4,4) })
apply(t(all_rankings), 2, mean)
?wilcox.text
wilcox.test(t(all_rankings)[,1], t(all_rankings)[,2])
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
library(ggplot2)
library(ggbeeswarm)
n <- 90
# One random permutation of 4 things
all_rankings = sapply(1:n, function(x) { sample(4,4) })
print(apply(t(all_rankings), 2, mean))
print(wilcox.test(t(all_rankings)[,1], t(all_rankings)[,2]))
print("Paired")
print(wilcox.test(t(all_rankings)[,1], t(all_rankings)[,2]),paired=TRUE)
library(ggplot2)
library(ggbeeswarm)
n <- 90
# One random permutation of 4 things
all_rankings = sapply(1:n, function(x) { sample(4,4) })
print(apply(t(all_rankings), 2, mean))
print(wilcox.test(t(all_rankings)[,1], t(all_rankings)[,2]))
print("Paired")
print(wilcox.test(t(all_rankings)[,1], t(all_rankings)[,2]),paired=TRUE)
source("~/stats.R")
wilcox.test(t(all_rankings)[,1], t(all_rankings)[,2],paired=TRUE)
names(wilcox.test(t(all_rankings)[,1], t(all_rankings)[,2],paired=TRUE))
wilcox.test(t(all_rankings)[,1], t(all_rankings)[,2],paired=TRUE)$p.value
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
?friedman.test
friedman.test(t(all_rankings))
friedman.test(t(all_rankings))
friedman.test(t(all_rankings))
friedman.test(t(all_rankings))
friedman.test(t(all_rankings))
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
source("~/stats.R")
?mann.whitney
??mann.whitney
wilcox.test(c(1.2, 1.5, 2), c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12))
length(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12))
45/(3*16)
wilcox.test(c(1.2, 1.5, 2), c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4))
wilcox.test(c(1.2, 1.5, 2), c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4))
42/(3*16)
source("~/Desktop/rlmN_story/phylogenetic_analysis/visualize_pim.R")
setwd("~/Desktop/rlmN_story/phylogenetic_analysis/")
source("~/Desktop/rlmN_story/phylogenetic_analysis/visualize_pim.R")
df
df[8:]
df[8,:]
df[8,]
rownames(df)
df[10,]
barplot(df[10,])
barplot(df[10,], las=2)
barplot(sort(df[10,]), las=2)
barplot(sort(df[10,], reverse=True), las=2)
barplot(sort(df[10,], reverse=TRUE), las=2)
?t.test
?sort
barplot(sort(df[10,], decreasing=TRUE), las=2)
?barplot
barplot(sort(df[10,], decreasing=TRUE), las=2)
par()
par()$mar
?par
par(mar=c(5.1, 4.1, 4.1, 2.1))
barplot(sort(df[10,], decreasing=TRUE), las=2)
par(mar=c(5.1, 4.1, 4.1, 3.1))
barplot(sort(df[10,], decreasing=TRUE), las=2)
par(mar=c(6.1, 4.1, 4.1, 2.1))
barplot(sort(df[10,], decreasing=TRUE), las=2)
barplot(sort(df[10,], decreasing=TRUE), las=2, col="blue")
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue")
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",)
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,50))
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40))
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%)")
hline(a=30, col="red")
?hline
?abline
abline(a=30, col="red")
abline(h=30, col="red")
abline(h=30, col="red", lty=4)
abline(h=30, col="red", lty=3)
abline(h=30, col="red")
?abline
?lty
??lty
par(mar=c(6.1, 4.1, 4.1, 2.1))
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%)")
abline(h=30, col="red")
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%)")
abline(h=30, col="red", lty=4)
abline(h=30, col="red", lty=3)
par(mar=c(6.1, 4.1, 4.1, 2.1))
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%)")
abline(h=30, col="red", lty=3)
par(mar=c(6.1, 4.1, 4.1, 2.1))
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%)")
abline(h=30, col="red", lty=2)
par(mar=c(6.1, 4.1, 4.1, 2.1))
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%)")
abline(h=30, col="red", lty=2,lwd=3)
par(mar=c(6.1, 4.1, 4.1, 2.1))
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%)")
abline(h=30, col="blue", lty=2,lwd=3)
?abline
text(100, 30, "text")
text(10, 30, "text")
text(10, 32, "text")
text(10, 31, "homology*")
text(10, 31, "homology threshold*")
text(10, 31, "threshold for homology*")
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%) to S. aureus rlmN")
abline(h=30, col="blue", lty=2,lwd=3)
text(10, 31, "threshold for homology*")
?xlab
??xlab
??barplot
barplot(c(364))
?rect
rect(0, 0, 364, 10)
rect(0, 0, 364, 10)
plot.new()
rect(0, 0, 364, 10)
?rect
rect(0, 0, 364, 10, col="blue")
rect(0, 0, 364, 20, col="blue")
plot.new()
plot.new()
rect(0, 0, 364, 20, col="blue")
rect(0, 10, 350, 20, col="red")
plot.new()
plot(0, type = "n", xlab = "genomic coordinate", ylab = "", xlim = c(0, 360), ylim = c(0, 50))
rect(0, 0, 364, 10, col="blue")
rect(0, 176, 364, 30, col="grey")
plot(0, type = "n", xlab = "genomic coordinate",
ylab = "", xlim = c(0, 360), ylim = c(0, 50))
rect(0, 0, 364, 10, col="blue")
rect(176, 20, 364, 30, col="grey")
?rect
rect(176, 20, 364, 30, density=10,
col="grey")
rect(176, 20, 364, 30, density=2,
col="grey")
?rect
rect(176, 20, 364, 30, density=2,
angle=45, col="grey",lty=2)
rect(176, 20, 364, 30, density=10,
angle=45, col="grey",lwd=0.2)
rect(0, 0, 364, 10, col="blue")
rect(176, 20, 364, 30, density=10,
angle=45, col="grey",lwd=0.2)
plot(0, type = "n", xlab = "genomic coordinate",
ylab = "", xlim = c(0, 360), ylim = c(0, 50))
rect(0, 0, 364, 10, col="blue")
rect(176, 20, 364, 30, density=10,
angle=45, col="grey",lwd=0.2)
rect(176, 0, 364, 10, density=10,
angle=45, col="grey",lwd=0.2)
rect(176, 0, 364, 10, density=40,
angle=45, col="grey",lwd=1)
rect(176, 0, 364, 10, density=20,
angle=45, col="grey",lwd=2)
plot(0, type = "n", xlab = "genomic coordinate",
ylab = "", xlim = c(0, 360), ylim = c(0, 50))
rect(0, 0, 364, 10, col="blue")
rect(176, 0, 364, 10, density=20,
angle=45, col="grey",lwd=2)
plot(0, type = "n", xlab = "genomic coordinate",
ylab = "", xlim = c(0, 360), ylim = c(0, 50))
rect(0, 0, 364, 5, col="blue")
rect(176, 0, 364, 5, density=20,
angle=45, col="grey",lwd=2)
plot(0, type = "n", xlab = "genomic coordinate",
ylab = "", xlim = c(0, 360), ylim = c(0, 50),
axes=FALSE)
rect(0, 0, 364, 5, col="blue")
rect(176, 0, 364, 5, density=20,
angle=45, col="grey",lwd=2)
axis(side=1)
rect(112, 7, 350, 10,
col="red")
?legend
legend(x=50, y=100, legend=c("gene", "fs", "SAM"),
fill=c("blue","grey","red"),
title="My legend")
legend(x=50, y=40, legend=c("gene", "fs", "SAM"),
fill=c("blue","grey","red"),
title="My legend")
legend(x=10, y=40, legend=c("gene", "fs", "SAM"),
fill=c("blue","grey","red"),
title="My legend")
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("blue","grey","red"),
title="My legend")
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("blue","grey","red"),
lty=c(1,2,1),
title="My legend")
?legend
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("blue","grey","red"),
angle=c(0,45,0),
title="My legend")
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("blue","grey","red"),
angle=c(0,45,0),
density=c(100,20,100),
title="My legend")
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("blue","grey","red"),
angle=c(0,45,0),
density=c(100,20,100),
lwd=c(2,2,2),
title="My legend")
rect(176, 0, 364, 5, density=40,
angle=45, col="grey",lwd=1)
rect(112, 7, 350, 10,
col="red")
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("blue","grey","red"),
angle=c(0,45,0),
density=c(100,40,100),
title="My legend")
plot(0, type = "n", xlab = "genomic coordinate",
ylab = "", xlim = c(0, 360), ylim = c(0, 50),
axes=FALSE)
axis(side=1)
rect(0, 0, 364, 5, col="blue")
rect(176, 0, 364, 5, density=40,
angle=45, col="grey",lwd=1)
rect(112, 7, 350, 10,
col="red")
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("blue","grey","red"),
angle=c(0,45,0),
density=c(100,40,100),
title="My legend")
plot(0, type = "n", xlab = "genomic coordinate",
ylab = "", xlim = c(0, 360), ylim = c(0, 50),
axes=FALSE)
axis(side=1)
rect(0, 0, 364, 5, col="grey")
rect(176, 0, 364, 5, density=40,
angle=45, col="blue",lwd=1)
rect(112, 7, 350, 10,
col="red")
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("grey","blue","red"),
angle=c(0,45,0),
density=c(100,40,100),
title="My legend")
plot(0, type = "n", xlab = "genomic coordinate",
ylab = "", xlim = c(0, 360), ylim = c(0, 50),
axes=FALSE)
axis(side=1)
rect(0, 0, 364, 5, col="grey")
rect(176, 0, 364, 5, density=40,
angle=45, col="red",lwd=1)
rect(112, 7, 350, 10,
col="blue")
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("grey","red","blue"),
angle=c(0,45,0),
density=c(100,40,100),
title="My legend")
plot(0, type = "n", xlab = "genomic coordinate",
ylab = "", xlim = c(0, 360), ylim = c(0, 50),
axes=FALSE)
axis(side=1)
rect(0, 0, 364, 5, col="grey")
rect(176, 0, 364, 5, density=40,
angle=45, col="red",lwd=1)
rect(112, 2, 350, 5,
col="blue")
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("grey","red","blue"),
angle=c(0,45,0),
density=c(100,40,100),
title="My legend")
plot(0, type = "n", xlab = "genomic coordinate",
ylab = "", xlim = c(0, 360), ylim = c(0, 50),
axes=FALSE)
axis(side=1)
rect(0, 0, 364, 5, col="grey")
rect(112, 2, 350, 5,
col="blue")
rect(176, 0, 364, 5, density=40,
angle=45, col="red",lwd=1)
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("grey","red","blue"),
angle=c(0,45,0),
density=c(100,40,100),
title="My legend")
plot(0, type = "n", xlab = "genomic coordinate",
ylab = "", xlim = c(0, 360), ylim = c(0, 50),
axes=FALSE)
axis(side=1)
rect(0, 0, 364, 5, col="grey")
rect(112, 2, 350, 4,
col="blue")
rect(176, 0, 364, 5, density=40,
angle=45, col="red",lwd=1)
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("grey","red","blue"),
angle=c(0,45,0),
density=c(100,40,100),
title="My legend")
?data.frame
?data.table
plot(0, type = "n", xlab = "genomic coordinate",
ylab = "", xlim = c(0, 360), ylim = c(0, 50),
axes=FALSE)
axis(side=1)
rect(0, 0, 364, 5, col="grey")
rect(112, 1, 350, 4,
col="blue")
rect(176, 0, 364, 5, density=40,
angle=45, col="red",lwd=1)
legend(x=10, y=40, legend=c("rlmN", "Affected by frameshift", "Radical SAM core"),
fill=c("grey","red","blue"),
angle=c(0,45,0),
density=c(100,40,100),
title="My legend")
source("~/Desktop/rlmN_story/phylogenetic_analysis/visualize_pim.R")
par(mar=c(6.1, 4.1, 4.1, 2.1))
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%) to S. aureus rlmN")
abline(h=30, col="blue", lty=3,lwd=3)
text(10, 31, "threshold for homology*")
par(mar=c(6.1, 4.1, 4.1, 2.1))
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%) to S. aureus rlmN")
abline(h=30, col="black", lty=3,lwd=3)
text(10, 31, "threshold for homology*")
text(10, 31, "homology threshold")
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%) to S. aureus rlmN")
abline(h=30, col="black", lty=3,lwd=3)
text(10, 31, "homology threshold")
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%) to S. aureus rlmN")
abline(h=30, col="black", lty=3,lwd=1)
text(10, 31, "homology threshold")
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%) to S. aureus rlmN")
abline(h=30, col="black", lty=2,lwd=1)
text(10, 31, "homology threshold")
abline(h=30, col="black", lty=2,lwd=2)
par(mar=c(6.1, 4.1, 4.1, 2.1))
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%) to S. aureus rlmN")
abline(h=30, col="black", lty=2,lwd=2)
text(10, 31, "homology threshold")
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%) to S. aureus rlmN")
abline(h=30, col="black", lty=2,lwd=1)
text(10, 30.5, "homology threshold")
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%) to S. aureus rlmN")
abline(h=30, col="black", lty=2,lwd=1)
text(10, 31, "homology threshold")
text(10, 30.75, "homology threshold")
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%) to S. aureus rlmN")
abline(h=30, col="black", lty=2,lwd=1)
text(10, 31, "homology threshold")
par(mar=c(6.1, 4.1, 4.1, 2.1))
barplot(sort(df[10,], decreasing=TRUE), las=2, col="lightblue",ylim=c(0,40),
ylab="Percent identity (%) to S. aureus rlmN")
abline(h=30, col="black", lty=2,lwd=1)
text(10, 31, "homology threshold")
source("~/Desktop/rlmN_story/phylogenetic_analysis/visualize_pim.R")
source("~/Desktop/rlmN_story/phylogenetic_analysis/visualize_pim.R")
source("~/Desktop/rlmN_story/phylogenetic_analysis/visualize_pim.R")
